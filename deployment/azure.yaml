# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

requiredVersions:
  azd: '>=1.21.2'
name: nlweb-agent-demo
services:
  ask:
    project: ../ask_api
    host: appservice
    language: python
    docker:
      path: ./Dockerfile
      context: ../ask_api
infra:
  path: infra
  module: main
hooks:
  postdeploy:
    windows:
      shell: pwsh
      run: ./scripts/create_app.ps1
      interactive: true
    posix:
      shell: sh
      run: ./scripts/create_app.sh
      interactive: true
  postprovision:
    windows:
      shell: pwsh
      run: ./scripts/load_data.ps1
      interactive: true
    posix:
      shell: sh
      run: ./scripts/load_data.sh
      interactive: true
  # AKS deployment hook - builds images and installs Helm chart
  # Run manually with: azd hooks run deploy-aks
  deploy-aks:
    posix:
      shell: sh
      run: ./scripts/deploy_aks.sh
      interactive: true
