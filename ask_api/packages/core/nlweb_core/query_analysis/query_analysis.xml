<?xml version="1.0" encoding="UTF-8"?>

 <QueryAnalysisSettings>

 <QueryAnalysis ref="DetectIrrelevantQueryPrompt" enabled="false" responseModel="IrrelevantQueryResponse">
    <method>defaultQueryAnalysisHandler</method>
      <promptString>
        The user is querying the site {request.site} which has information about {site.itemType}s.
        Is the site utterly completely irrelevant to the user's query?
        The question is not whether this is the best site for answering the query,
        but if there is nothing on the site that is likely to be relevant for the query.
        If the site is irrelevant, add an explanation for why it is irrelevant. Otherwise, leave that field blank.
        The user query is: '{request.query}'
      </promptString>
    </QueryAnalysis>

    <QueryAnalysis ref="NoContextTransliterator" enabled="true" responseModel="TransliterationResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        The user is querying the site {request.site}.

        IMPORTANT: Convert the query to English. Translate Hindi/Devanagari queries to English.
        - If the query is in Devanagari (Hindi script), translate it to English
        - If the query is in Hinglish (romanized Hindi), translate it to English
        - If the query is already in English, keep it as is
        - Keep proper nouns (names of people, places, trains, missions, campaigns) in their standard romanized form - do NOT translate them

        Examples:
        - "ट्रम्प ने मोदी की तारीफ की" → "Trump praised Modi"
        - "निर्मला सीतारमण" → "Nirmala Sitharaman"
        - "वंदे भारत ट्रेन" → "Vande Bharat train"
        - "स्वच्छ भारत मिशन" → "Swachh Bharat mission"
        - "mumbai mein barish" → "rain in Mumbai"
        - "nirmala sitharaman budget" → "Nirmala Sitharaman budget" (keep as is)
        - "swachh bharat" → "Swachh Bharat" (keep as is - mission name)

        The user's query is: {request.rawQuery}.
      </promptString>
    </QueryAnalysis>

    <QueryAnalysis ref="PrevQueryDecontextualizer" enabled="true" responseModel="DecontextualizationResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        The user is querying the site {request.site}.
        Rewrite the query, incorporating the context of the previous queries and answers.
        Keep the decontextualized query short and do not reference the site.

        If the query very clearly does not reference earlier queries,
        don't change the query. Err on the side of incorporating the context of the
        previous queries. If you are not sure whether this is a brand new query,
        or follow up, it is likely a follow up. Try your best to incorporate the
        context from the previous queries.

        The user's query is: {request.rawQuery}.
        Previous queries were: {request.previousQueries}.
       <!-- Previous answers (title + url)provided were: {request.prevAnswers}. -->
      </promptString>
    </QueryAnalysis>

     <QueryAnalysis ref="ContextDecontextualizer" enabled="true" responseModel="DecontextualizationResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        The user is querying the site {request.site}.
        Rewrite the query, incorporating the context .
        Keep the decontextualized query short and do not reference the site.

        If the query very clearly does not reference earlier queries,
        don't change the query. Err on the side of incorporating the context. If you are not sure whether this is a brand new query,
        or follow up, it is likely a follow up. Try your best to incorporate the
        context from the previous queries.

        The user's query is: {request.rawQuery}.
        Previous context is: request.context}.
       <!-- Previous answers (title + url)provided were: {request.prevAnswers}. -->
      </promptString>
    </QueryAnalysis>

    <QueryAnalysis ref="FullContextDecontextualizer" enabled="true" responseModel="DecontextualizationResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        The user is querying the site {request.site}.
        Rewrite the query, incorporating the context and previous queries.
        Keep the decontextualized query short and do not reference the site.

        If the query very clearly does not reference earlier queries,
        don't change the query. Err on the side of incorporating the context. If you are not sure whether this is a brand new query,
        or follow up, it is likely a follow up. Try your best to incorporate the
        context from the previous queries.

        The user's query is: {request.rawQuery}.
        Previous queries were: {request.previousQueries}
        Previous context is: {request.context}.
       <!-- Previous answers (title + url)provided were: {request.prevAnswers}. -->
      </promptString>
    </QueryAnalysis>

    <QueryAnalysis ref="PrevQueryDecontextualizerHindi" enabled="true" responseModel="DecontextualizationResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        The user is querying a Hindi news site that uses Hindi content.

        IMPORTANT: Output the decontextualized query in English. Translate Hindi/Devanagari to English.
        - If the query is in Devanagari (Hindi script), translate it to English
        - If the query is in Hinglish (romanized Hindi), translate it to English
        - Keep proper nouns (names of people, places, trains, missions, campaigns) in their standard romanized form - do NOT translate them

        Examples:
        - "ट्रम्प ने मोदी की तारीफ की" → "Trump praised Modi"
        - "निर्मला सीतारमण" → "Nirmala Sitharaman"
        - "वंदे भारत ट्रेन" → "Vande Bharat train"
        - "स्वच्छ भारत मिशन" → "Swachh Bharat mission"
        - "mumbai mein barish" → "rain in Mumbai"
        - "nirmala sitharaman budget" → "Nirmala Sitharaman budget" (keep as is)
        - "swachh bharat" → "Swachh Bharat" (keep as is - mission name)

        Rewrite the query, incorporating the context of the previous queries and answers.
        Keep the decontextualized query short and do not reference the site.

        If the query very clearly does not reference earlier queries,
        don't change the query. Err on the side of incorporating the context of the
        previous queries. If you are not sure whether this is a brand new query,
        or follow up, it is likely a follow up. Try your best to incorporate the
        context from the previous queries.

        The user's query is: {request.rawQuery}.
        Previous queries were: {request.previousQueries}.
      </promptString>
    </QueryAnalysis>

    <QueryAnalysis ref="FullContextDecontextualizerHindi" enabled="true" responseModel="DecontextualizationResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        The user is querying a Hindi news site that uses Hindi content.

        IMPORTANT: Output the decontextualized query in English. Translate Hindi/Devanagari to English.
        - If the query is in Devanagari (Hindi script), translate it to English
        - If the query is in Hinglish (romanized Hindi), translate it to English
        - Keep proper nouns (names of people, places, trains, missions, campaigns) in their standard romanized form - do NOT translate them

        Examples:
        - "ट्रम्प ने मोदी की तारीफ की" → "Trump praised Modi"
        - "निर्मला सीतारमण" → "Nirmala Sitharaman"
        - "वंदे भारत ट्रेन" → "Vande Bharat train"
        - "स्वच्छ भारत मिशन" → "Swachh Bharat mission"
        - "mumbai mein barish" → "rain in Mumbai"
        - "nirmala sitharaman budget" → "Nirmala Sitharaman budget" (keep as is)
        - "swachh bharat" → "Swachh Bharat" (keep as is - mission name)

        Rewrite the query, incorporating the context and previous queries.
        Keep the decontextualized query short and do not reference the site.

        If the query very clearly does not reference earlier queries,
        don't change the query. Err on the side of incorporating the context. If you are not sure whether this is a brand new query,
        or follow up, it is likely a follow up. Try your best to incorporate the
        context from the previous queries.

        The user's query is: {request.rawQuery}.
        Previous queries were: {request.previousQueries}
        Previous context is: {request.context}.
      </promptString>
    </QueryAnalysis>


    <QueryAnalysis ref="DetectMemoryRequestPrompt" enabled="false" responseModel="MemoryRequestResponse">
        <method>defaultQueryAnalysisHandler</method>
      <promptString>
        Analyze the following statement from the user.
        Is the user asking you to remember, that may be relevant to not just this query, but also future queries?
        If so, what is the user asking us to remember?
        The user should be explicitly asking you to remember something for future queries,
        not just expressing a requirement for the current query.
        Keep the memory_request field short and do not reference the user or site.
        The user's query is: {request.rawQuery}.
      </promptString>
    </QueryAnalysis>

    <QueryAnalysis ref="QueryRewrite" enabled="true" responseModel="QueryRewriteResponse">
  <method>defaultQueryAnalysisHandler</method>
      <promptString>
        You are helping to rewrite a complex search query into simpler keyword queries for a traditional keyword-based search engine.
        The search engine works best with short, focused queries containing important keywords.

        Take the following query and break it down into up to 5 simpler search queries.
        Each query should:
        - Contain no more than 3 words
        - Focus on the most important keywords and concepts
        - Be diverse to cover different aspects of the original query
        - Use only essential nouns, adjectives, or product terms
        - Avoid common words like "for", "the", "some", "are", "that", "would", "be"

        For example:
        - "what are some options for plates that would be appropriate for serving vegetables" → ["vegetable plates", "serving plates", "dinner plates", "salad plates", "ceramic plates"]
        - "looking for a tea pot that can brew green tea" → ["tea pot", "green tea", "teapot ceramic", "japanese teapot", "brewing pot"]

        The original query is: {request.query}
      </promptString>
    </QueryAnalysis>

    <QueryAnalysis ref="DetectItemTypesQueryPrompt" enabled="false" responseModel="ItemTypesResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        Analyze the following query from the user.
        What are the kinds of items the user is asking for.
        If the user is asking for multiple kinds of items, for each item, construct a query.
        The user's query is: {request.query}.
      </promptString>
    </QueryAnalysis>


    <QueryAnalysis ref="DetectItemDetailPrompt" responseModel="ItemDetailResponse">
      <method>defaultQueryAnalysisHandler</method>
      <promptString>
        Analyze the following query from the user.
        Is the user asking for a list of {site.itemType} that match a certain description or are they asking for the
        details of a particular {site.itemType}?
        If the user for the details of a particular {site.itemType}, what is the name of the {site.itemType} and what
        details are they asking for? The user's query is: {request.query}.
      </promptString>
    </QueryAnalysis>

    </QueryAnalysisSettings>
