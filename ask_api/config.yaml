# NLWeb Configuration for Azure Hello World Example
# This configuration uses Azure OpenAI for LLM/embeddings and Azure AI Search for retrieval

port: 8000

# Generative model providers (for text/JSON generation)
generative_model:
  high:
    model: gpt-4.1
    endpoint_env: AZURE_OPENAI_ENDPOINT
    api_key_env: AZURE_OPENAI_KEY
    api_version: "2024-08-01-preview"
    auth_method: api_key
    import_path: nlweb_azure_models.llm.azure_oai
    class_name: AzureOpenAIProvider
  low:
    model: gpt-4.1-mini
    endpoint_env: AZURE_OPENAI_ENDPOINT
    api_key_env: AZURE_OPENAI_KEY
    api_version: "2024-08-01-preview"
    auth_method: api_key  # Use 'azure_ad' for managed identity
    import_path: nlweb_azure_models.llm.azure_oai
    class_name: AzureOpenAIProvider

embedding:
  provider: azure_openai
  import_path: nlweb_azure_models.embedding.azure_oai_embedding
  class_name: get_azure_embedding
  endpoint_env: AZURE_OPENAI_ENDPOINT
  api_key_env: AZURE_OPENAI_KEY
  auth_method: api_key  # Use 'azure_ad' for managed identity
  model: text-embedding-3-small

# Scoring model configuration - supports multiple named providers
scoring_model:
  default:
    import_path: nlweb_pilabs_models.llm.pi_labs
    class_name: PiLabsScoringProvider
    endpoint_env: PI_LABS_ENDPOINT
    api_key_env: PI_LABS_KEY
  # Example: Additional Azure OpenAI scoring provider
  # azure:
  #   model: gpt-4.1-mini
  #   endpoint_env: AZURE_OPENAI_ENDPOINT
  #   api_key_env: AZURE_OPENAI_KEY
  #   api_version: "2024-08-01-preview"
  #   auth_method: api_key
  #   import_path: nlweb_azure_models.llm.azure_oai
  #   class_name: AzureOpenAIScoringProvider


retrieval:
  provider: azure_ai_search
  import_path: nlweb_azure_vectordb.azure_search_client
  class_name: AzureSearchClient
  api_endpoint_env: AZURE_SEARCH_ENDPOINT
  api_key_env: AZURE_SEARCH_KEY
  auth_method: api_key # Use 'azure_ad' for managed identity
  index_name: crawler-vectors

object_storage:
  default:
    endpoint_env: COSMOS_DB_ENDPOINT
    database_name_env: COSMOS_DB_DATABASE_NAME
    container_name_env: COSMOS_DB_CONTAINER_NAME
    partition_key: /"@id"
    import_path: nlweb_cosmos_object_db.cosmos_lookup
    class_name: CosmosObjectLookup

site_config:
  default:
    endpoint_env: COSMOS_DB_ENDPOINT
    database_name_env: COSMOS_DB_DATABASE_NAME
    container_name: site_configs
    cache_ttl: 300  # Cache TTL in seconds (5 minutes)
    import_path: nlweb_cosmos_site_config.site_config_lookup
    class_name: CosmosSiteConfigLookup
  handler:
    import_path: nlweb_core.site_config.static_site_config
    class_name: StaticSiteConfigLookup
    sites:
      aajtak.in:
        ask_handler_class: AajtakAskHandler
        ask_handler_import_path: nlweb_core.aajtak

server:
  host: 0.0.0.0

ranking_config:
  scoring_questions:
    - "Is this item relevant to the query?"
